I"r)<div class="columns">
<div class="column">

    <p>Nachdem ich vor zwei Jahrzehnten als Mittelschullehrer Python unterrichtet habe,
entwickle ich seit einiger Zeit auch wieder vermehrt mit Python. Es eignet sich
vorzüglich im wissenschaftlichen Umfeld (Datenanalyse, Big Data KI, AI) zum
Scripten, aber auch für serverseitige Webapplikationen.</p>

    <p>Manchmal muss man einfach ein wenig über den eigenen Tellerrand hinausdenken,
um die Möglichkeiten dieser Sprache auszunutzen. Ein kleines Beispiel gefällig.</p>

    <h2 id="blindengerechtes-wifi-radio">Blindengerechtes Wifi-Radio</h2>

    <p>Mein blinder Vater hatte seinen Leben lang nie Personal Computer verwendet,
er hielt sich nicht über das Internet sondern über viele weltweite
Radiostationen up to date. Doch die internationalen Mittel- und Langwellensender
wurden immer weniger. Da hatte ich eine Idee.</p>

    <p>Ich funktionierte einen alten Laptop in ein blindengerechtes Wifi-Radio um,
indem ich eine minimale Linux-Distribution ohne graphisches Nutzerinterface
installierte. Mein Vater erhielt einen Account, der automatisch beim Booten des
Geräts angemeldet wird. Unmittelbar wird ein Python-Skript gestartet, dass
jede Tastaturinteraktion abfängt und für jede Taste einen anderen Internetradio-Stream
startet, der über Kopfhörer oder die eingebauten Lautsprecher des Laptops
wiedergegeben wird. Da es sich um einen Laptop handelt, ist die Lösung innerhalb
der Reichweite des Wlans mobil.</p>

    <p>Das kleine Script, von dem sie alle wesentlichen Komponenten hier sehen,
ist seit Jahren im täglichen Einsatz. Hin und wieder verstirbt die Hardware
des Laptops, dann setze ich eine idente Umgebung wieder auf und mein Vater
hat wieder 40 Radiostationen at his finger tip. Um sich nicht die Position aller
Sender merken zu müssen, sagt das Script auch mit jedem Tastendruck, welcher
Sender nun gestartet wird.</p>

    <p>Beim Neustart des Rechners wird das Script über das Internet neu bezogen,
sodass es mir möglich ist, die Senderliste aus der Ferne aktuell zu halten, wenn
sich der URL eines Streams ändert.</p>

    <h3 id="links">Links</h3>

    <ul>
      <li>Den kompletten Quellcode und die Senderkennungsfiles finden Sie 
im Github-Repo <a href="https://github.com/haslinger/internet_radio">internet_radio</a>.</li>
    </ul>

  </div>
<div class="column is-half">

    <h3 id="quellcode">Quellcode</h3>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
# -*- coding: utf-8 -*-
</span>
<span class="c1"># Module importieren
</span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">curses</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">tune_in</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
  <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'killall mplayer'</span><span class="p">)</span>
  <span class="n">ansage</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
  <span class="n">play</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'mplayer -really-quiet -nolirc -ao alsa -cache 128 '</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span>
  <span class="s">' &lt; /dev/null &gt; /dev/null &amp;'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ansage</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
  <span class="n">play</span><span class="p">(</span><span class="s">'~/internet_radio/ansagen/'</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="s">'.mp3'</span><span class="p">)</span>

<span class="c1">#Lautstaerke setzen
</span><span class="n">volume</span> <span class="o">=</span> <span class="mi">50</span> 
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'amixer set Master '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">volume</span><span class="p">))</span>
<span class="c1"># Curses Modus starten
</span><span class="n">stdscr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">initscr</span><span class="p">()</span>
<span class="n">curses</span><span class="o">.</span><span class="n">noecho</span><span class="p">()</span>
<span class="n">curses</span><span class="o">.</span><span class="n">cbreak</span><span class="p">()</span>
<span class="n">stdscr</span><span class="o">.</span><span class="n">keypad</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Standardsender OE1
</span><span class="n">tune_in</span><span class="p">(</span><span class="s">'oe1'</span><span class="p">,</span> <span class="s">'http://mp3stream3.apasf.apa.at:8000'</span><span class="p">)</span>

<span class="c1"># Texthilfe
</span><span class="n">pad</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newpad</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>

<span class="c1"># lauter
</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="n">ansage</span><span class="p">(</span><span class="s">'lauter'</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'amixer set Master '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">volume</span><span class="p">))</span>
<span class="c1"># leister
</span>  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">-</span> <span class="mi">5</span>
        <span class="n">ansage</span><span class="p">(</span><span class="s">'leiser'</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'amixer set Master '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">volume</span><span class="p">))</span>
<span class="c1"># Sender je nach gedrueckter Taste abspielen
</span>  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'1'</span><span class="p">):</span>
    <span class="n">tune_in</span><span class="p">(</span><span class="s">'oe1'</span><span class="p">,</span>
            <span class="s">'http://mp3stream3.apasf.apa.at:8000'</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'2'</span><span class="p">):</span>
    <span class="n">tune_in</span><span class="p">(</span><span class="s">'radio_wien'</span><span class="p">,</span>
            <span class="s">'-playlist https://oe2wshoutcast.sf.apa.at/listen.pls'</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'3'</span><span class="p">):</span>
    <span class="n">tune_in</span><span class="p">(</span><span class="s">'oe3'</span><span class="p">,</span>
            <span class="s">'-playlist http://mp3stream7.apasf.apa.at:8000/listen.pls'</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'4'</span><span class="p">):</span>
    <span class="c1"># weitere Sender folgen hier...
</span>
<span class="c1"># Wartungsmodus mit PAGE DOWN (d.h. Programm sauber beenden)
</span>  <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_NPAGE</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'killall mplayer'</span><span class="p">)</span>
    <span class="k">break</span>
<span class="c1"># Curses Modus sauber beenden
</span><span class="n">curses</span><span class="o">.</span><span class="n">nocbreak</span><span class="p">()</span>
<span class="n">stdscr</span><span class="o">.</span><span class="n">keypad</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">curses</span><span class="o">.</span><span class="n">echo</span><span class="p">()</span>
<span class="n">curses</span><span class="o">.</span><span class="n">endwin</span><span class="p">()</span>

</code></pre></div>    </div>

  </div></div>
:ET